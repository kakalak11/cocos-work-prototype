{"version":3,"sources":["spaceboy.js"],"names":["cc","Class","extends","Component","properties","_animating","_moving","_direction","_canShoot","_speed","bulletPrefab","Prefab","_jump","jumpThrough","animation","setAnimation","node","runAction","moveBy","setCompleteListener","_move","direction","action","sequence","spawn","easing","easeSineInOut","scaleTo","callFunc","addAnimation","_shoot","bullet","instantiate","parent","addChild","setPosition","v2","getPosition","y","x","scale","script","getComponent","_onKeyDown","event","log","keyCode","macro","KEY","space","a","scaleX","d","w","_onKeyUp","onCollisionEnter","other","self","onCollisionStay","stopAction","onCollisionExit","console","onLoad","manager","director","getCollisionManager","enabled","enabledDebugDraw","setInterruptListener","start","update","dt","setStartListener","ani"],"mappings":"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","file":"spaceboy.js","sourceRoot":"../../../../../assets/newScene/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _animating: false,\n        _moving: null,\n        _direction: 1,\n        _canShoot: null,\n        _speed: 3,\n        bulletPrefab: cc.Prefab,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    _jump: function () {\n        this.jumpThrough = true;\n        this._moving = true;\n        this.animation.setAnimation(0, 'jump', false);\n        this.node.runAction(cc.moveBy(1, 120 * this._direction, 0));\n        this.animation.setCompleteListener(() => {\n            this.animation.setCompleteListener(() => { });\n            this.animation.setAnimation(0, 'idle', true);\n            this.jumpThrough = false;\n            this._moving = false;\n        });\n    },\n\n    _move: function (direction) {\n        this._direction = direction;\n        if (this._moving) return;\n        this._moving = true;\n        this.action = cc.sequence(\n            cc.spawn(\n                cc.moveBy(0.5, 60 * this._direction, 0).easing(cc.easeSineInOut(0.5)),\n                cc.scaleTo(0, 0.1 * this._direction, 0.1),\n                cc.callFunc(() => this.animation.setAnimation(0, 'run', true)),\n            ),\n            cc.callFunc(() => this._moving = false),\n            cc.callFunc(() => this.animation.addAnimation(0, 'idle', true)),\n        );\n        this.node.runAction(this.action);\n    },\n\n    _shoot: function () {\n        this.bullet = cc.instantiate(this.bulletPrefab);\n        this.node.parent.addChild(this.bullet);\n        this.bullet.setPosition(cc.v2(this.node.getPosition(cc.v2())));\n        this.bullet.y += 25;\n        this.bullet.x += 25;\n        this.bullet.scale = 0.1;\n        this.script = this.bullet.getComponent('bullet');\n        this.script.direction = this._direction;\n        this.animation.setAnimation(0, 'shoot', false);\n        this.animation.setCompleteListener(() => {\n            this.animation.setCompleteListener(() => { });\n            this.animation.setAnimation(0, 'idle', true);\n        });\n    },\n\n    _onKeyDown: function (event) {\n        cc.log('key down');\n        switch (event.keyCode) {\n            case cc.macro.KEY.space:\n                this._shoot();\n                break;\n            case cc.macro.KEY.a:\n                // this._move(-1);\n                this._moving = true;\n                this._direction = -1;\n                this.node.scaleX = -0.1;\n                break;\n            case cc.macro.KEY.d:\n                // this._move(1);\n                this._moving = true;\n                this._direction = 1;\n                this.node.scaleX = 0.1;\n                break;\n            case cc.macro.KEY.w:\n                this._jump();\n                break;\n\n        }\n    },\n\n    _onKeyUp: function () {\n        this._moving = false;\n    },\n\n    onCollisionEnter: function (other, self) {\n        cc.log('on collision enter');\n        this.node.x -= this._speed * this._direction;\n        this._moving = false;\n    },\n\n    onCollisionStay: function (other, self) {\n        if (!this.jumpThrough) {\n            self.node.x += -this._direction * 2;\n            this.node.stopAction(this.action);\n            this.animation.setAnimation(0, 'idle', true);\n            this._moving = false;\n        }\n\n    },\n\n    onCollisionExit: function (other, self) {\n        console.log('on collision exit');\n        // this._collision = false;\n        this._canShoot = false;\n    },\n\n    onLoad() {\n        this.animation = this.node.getComponent('sp.Skeleton');\n        let manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        manager.enabledDebugDraw = true;\n        // manager.enabledDrawBoundingBox = true;\n        // cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this._onKeyDown, this);\n        // cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this._onKeyUp, this);(\n        this.animation.setAnimation(0, 'idle', true);\n        this.animation.setInterruptListener(() => {\n            // this.animation.setAnimation(0, 'run', false);\n        })\n    },\n\n    start() {\n        // this.node.emit('test');\n    },\n\n    update(dt) {\n        // this.node.runAction(cc.moveBy(0.25, 10, 0));\n        if (!this._moving) {\n            this.animation.setAnimation(0, 'idle', true);\n            this.animation.setStartListener(() => {\n                this.animation.setCompleteListener(() => {\n                    this.ani\n                })\n            })\n        }\n        if (this._moving) {\n            this.node.x += this._speed * this._direction;\n\n            if (!this._animating) {\n                // this._animating = true;\n                this.animation.setAnimation(0, 'run', false);\n                this.animation.setStartListener(() => {\n                    this._animating = true;\n                    this.animation.setCompleteListener(() => {\n                        this._animating = false;\n                    })\n                });\n            }\n        }\n    },\n});\n"]}