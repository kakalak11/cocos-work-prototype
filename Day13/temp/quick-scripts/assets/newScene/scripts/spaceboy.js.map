{"version":3,"sources":["spaceboy.js"],"names":["cc","Class","extends","Component","properties","_animating","_moving","_direction","_canShoot","bulletPrefab","Prefab","_jump","jumpThrough","animation","setAnimation","node","runAction","moveBy","setCompleteListener","_move","direction","action","sequence","spawn","easing","easeSineInOut","scaleTo","callFunc","addAnimation","_shoot","bullet","instantiate","addChild","script","getComponent","_onKeyDown","event","log","keyCode","macro","KEY","space","a","d","w","onCollisionEnter","other","self","onCollisionStay","x","stopAction","onCollisionExit","console","onLoad","manager","director","getCollisionManager","enabled","enabledDebugDraw","systemEvent","on","SystemEvent","EventType","KEY_DOWN","start","emit","update","dt"],"mappings":"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","file":"spaceboy.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\newScene\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _animating: false,\r\n        _moving: null,\r\n        _direction: 1,\r\n        _canShoot: null,\r\n        bulletPrefab: cc.Prefab,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    _jump: function () {\r\n        this.jumpThrough = true;\r\n        this._moving = true;\r\n        this.animation.setAnimation(0, 'jump', false);\r\n        this.node.runAction(cc.moveBy(1, 120 * this._direction, 0));\r\n        this.animation.setCompleteListener(() => {\r\n            this.animation.setCompleteListener(() => { });\r\n            this.animation.setAnimation(0, 'idle', true);\r\n            this.jumpThrough = false;\r\n            this._moving = false;\r\n        });\r\n    },\r\n\r\n    _move: function (direction) {\r\n        this._direction = direction;\r\n        if (this._moving) return;\r\n        this._moving = true;\r\n        this.action = cc.sequence(\r\n            cc.spawn(\r\n                cc.moveBy(0.5, 60 * this._direction, 0).easing(cc.easeSineInOut(0.5)),\r\n                cc.scaleTo(0, 0.1 * this._direction, 0.1),\r\n                cc.callFunc(() => this.animation.setAnimation(0, 'run', true)),\r\n            ),\r\n            cc.callFunc(() => this._moving = false),\r\n            cc.callFunc(() => this.animation.addAnimation(0, 'idle', true)),\r\n        );\r\n        this.node.runAction(this.action);\r\n    },\r\n\r\n    _shoot: function () {\r\n        this.bullet = cc.instantiate(this.bulletPrefab);\r\n        this.node.addChild(this.bullet);\r\n        this.script = this.bullet.getComponent('bullet');\r\n        this.script.direction = this._direction;\r\n        this.animation.setAnimation(0, 'shoot', false);\r\n        this.animation.setCompleteListener(() => {\r\n            this.animation.setCompleteListener(() => { });\r\n            this.animation.setAnimation(0, 'idle', true);\r\n        });\r\n    },\r\n\r\n    _onKeyDown: function (event) {\r\n        cc.log('key down');\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.space:\r\n                this._shoot();\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this._move(-1);\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this._move(1);\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this._jump();\r\n                break;\r\n\r\n        }\r\n    },\r\n\r\n    onCollisionEnter: function (other, self) {\r\n        cc.log('on collision enter');\r\n    },\r\n\r\n    onCollisionStay: function (other, self) {\r\n        if (!this.jumpThrough) {\r\n            self.node.x += -this._direction * 2;\r\n            this.node.stopAction(this.action);\r\n            this.animation.setAnimation(0, 'idle', true);\r\n            this._moving = false;\r\n        }\r\n\r\n    },\r\n\r\n    onCollisionExit: function (other, self) {\r\n        console.log('on collision exit');\r\n        // this._collision = false;\r\n        this._canShoot = false;\r\n    },\r\n\r\n    onLoad() {\r\n        this.animation = this.node.getComponent('sp.Skeleton');\r\n        let manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n        manager.enabledDebugDraw = true;\r\n        // manager.enabledDrawBoundingBox = true;\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this._onKeyDown, this);\r\n    },\r\n\r\n    start() {\r\n        this.node.emit('test');\r\n    },\r\n\r\n    update(dt) {\r\n        // this.node.runAction(cc.moveBy(0.25, 10, 0));\r\n    },\r\n});\r\n"]}